cff_raw <- read.csv("final_cff_data_27_july_2021.csv",
header = T,
sep = ",")
colnames(cff_raw)[1] <- "Scientific_name"
#cff_raw[cff_raw$mode_of_life == "scavenger",]$mode_of_life <- "pred_forage"
#cff_raw[cff_raw$mode_of_life == "herbivore",]$mode_of_life <- "pred_forage"
#cff_raw[cff_raw$Habitat == "marine_reef",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "benthopelagic",]$Habitat <- "pelagic"
#cff_raw[cff_raw$Habitat == "bathypelagic",]$Habitat <- "pelagic"
cff_raw[cff_raw$Habitat == "arboreal",]$Habitat <- "terrestrial"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("pred_forage",
"deposite",
"pred_ballistic",
"pred_pursuit"
))
cff_raw$Habitat <- factor(cff_raw$Habitat,
levels = c("terrestrial",
#"arboreal",
"pelagic",
"demersal",
"volant"
))
cff_clean <- cff_raw[,c("Scientific_name",
"taxa_group",
"taxa_phyla",
"taxa_class",
"Light_Level",
"Method",
"Max_CFF_Hz",
"Bodymass.g.",
"Habitat",
"mode_of_life")]
cff_clean <- data.frame(cff_clean, animal = cff_clean$Scientific_name)
cff_clean <- na.omit(cff_clean)
library(phytools)
library(caper)
library(MCMCglmm)
library(hdrcde)
source("MultiDisPlot.R")
cff_raw <- read.csv("final_cff_data_27_july_2021.csv",
header = T,
sep = ",")
colnames(cff_raw)[1] <- "Scientific_name"
#cff_raw[cff_raw$mode_of_life == "scavenger",]$mode_of_life <- "pred_forage"
#cff_raw[cff_raw$mode_of_life == "herbivore",]$mode_of_life <- "pred_forage"
#cff_raw[cff_raw$Habitat == "marine_reef",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "benthopelagic",]$Habitat <- "pelagic"
#cff_raw[cff_raw$Habitat == "bathypelagic",]$Habitat <- "pelagic"
cff_raw[cff_raw$Habitat == "arboreal",]$Habitat <- "terrestrial"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("pred_forage",
"deposite",
"pred_ballistic",
"pred_pursuit"
))
cff_raw$Habitat <- factor(cff_raw$Habitat,
levels = c("terrestrial",
#"arboreal",
"pelagic",
"demersal",
"volant"
))
cff_clean <- cff_raw[,c("Scientific_name",
"taxa_group",
"taxa_phyla",
"taxa_class",
"Light_Level",
"Method",
"Max_CFF_Hz",
"Bodymass.g.",
"Habitat",
"mode_of_life")]
cff_clean <- data.frame(cff_clean, animal = cff_clean$Scientific_name)
cff_clean <- na.omit(cff_clean)
cff_tree <- read.tree("cff_tree_27_july_2021.tree")
cff_tree <- cff_tree[1:100]
cff_mul <- as.mulTree(cff_clean,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
library("mulTree")
cff_mul <- as.mulTree(cff_clean,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
nitt <- 120000
thin <- 50
burnin <- 20000
parameters <- c(nitt,
thin,
burnin)
prior <-list(R = list(V = 1, nu=0.002),
G = list(G1=list(V = 1,n = 2,
alpha.mu= 0,
alpha.V = 10^3)
))
Main_models <-   read.mulTree(mulTree.chain = "mulTree_models",
convergence = FALSE,
model = FALSE,
extract = NULL)
inter_main_p <-  hdr(Main_models$`(Intercept)`)
mass_log10_main_p <-  hdr(Main_models$`log10(Bodymass.g.)`)
lit_low_main_p <-  hdr(Main_models$Light_Levellow)
deposite_main_p <-  hdr(Main_models$mode_of_lifedeposite)
ballistic_main_p <-  hdr(Main_models$mode_of_lifepred_ballistic)
#scav_main_p <-  hdr(Main_models$mode_of_lifescavenger)
pur_main_p <-  hdr(Main_models$mode_of_lifepred_pursuit)
#herb_main_p <-  hdr(Main_models$mode_of_lifeherbivore)
pel_main_p <-  hdr(Main_models$Habitatpelagic)
dem_main_p <-  hdr(Main_models$Habitatdemersal)
#reef_main_p <-  hdr(Main_models$Habitatmarine_reef)
#bath_main_p <-  hdr(Main_models$Habitatbathypelagic)
vol_main_p <-  hdr(Main_models$Habitatvolant)
#arb_main_p <-  hdr(Main_models$Habitatarboreal)
#bentpelagic_main_p <-  hdr(Main_models$Habitatbenthopelagic)
body_lit_inter_main_p <-  hdr(Main_models$`log10(Bodymass.g.):Light_Levellow`)
phylo_main_p <-  hdr(Main_models$phylogenetic.variance)
H_main <- Main_models$phylogenetic.variance/c(Main_models$phylogenetic.variance + Main_models$residual.variance)
unit_main_p <-  hdr(Main_models$residual.variance)
mass_log10_main_p
dev.new()
plot(cff_raw$Max_CFF_Hz ~ log10(cff_raw$Bodymass.g.),
col = "white",
pch = 16,
bty = "n",
ylab = "CFF (Hz)",
xlab = "log10 of Mass (g)")
points(cff_raw[cff_raw$Light_Level == "low", "Max_CFF_Hz"] ~ log10(cff_raw[cff_raw$Light_Level == "low", "Bodymass.g."]),
col = "grey70",
pch= 16)
points(cff_raw[cff_raw$Light_Level == "high", "Max_CFF_Hz"] ~ log10(cff_raw[cff_raw$Light_Level == "high", "Bodymass.g."]),
col = rgb(247/250,224/250,89/250),
pch= 16)
points(cff_raw[cff_raw$Habitat== "volant", "Max_CFF_Hz"] ~ log10(cff_raw[cff_raw$Habitat== "volant", "Bodymass.g."]),
col = "white",
pch= 16, cex = 0.5)
##high light
abline(inter_main_p$mode, mass_log10_main_p$mode,
col = rgb(247/250,224/250,89/250),
lty = 4,
lwd = 3)
##low light
abline(inter_main_p$mode + lit_low_main_p$mode,
mass_log10_main_p$mode + body_lit_inter_main_p$mode,
col = "grey70",
lty = 4,
lwd = 3)
cff_t <- cff_clean[cff_clean$Habitat %in% c("volant",
"terrestrial"
#,"arboreal"
),]
cff_t$Habitat <- factor(cff_t$Habitat,
levels = c("terrestrial",
"volant"
#,"arboreal"
))
cff_mul_terr <- as.mulTree(cff_t,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
ter_models <-   read.mulTree(mulTree.chain = "cff_terr_models",
convergence = FALSE,
model = FALSE,
extract = NULL)
getwd()
setwd("~/Desktop/GitHub/CFF_full_animal")
ter_models <-   read.mulTree(mulTree.chain = "cff_terr_models",
convergence = FALSE,
model = FALSE,
extract = NULL)
inter_ter_p <-  hdr(ter_models$`(Intercept)`)
mass_log10_ter_p <-  hdr(ter_models$`log10(Bodymass.g.)`)
lit_low_ter_p <-  hdr(ter_models$Light_Levellow)
ballistic_ter_p <-  hdr(ter_models$mode_of_lifepred_ballistic)
#scav_ter_p <-  hdr(ter_models$mode_of_lifescavenger)
pur_ter_p <-  hdr(ter_models$mode_of_lifepred_pursuit)
#herb_ter_p <-  hdr(ter_models$mode_of_lifeherbivore)
vol_ter_p <-  hdr(ter_models$Habitatvolant)
#arb_ter_p <-  hdr(ter_models$Habitatarboreal)
body_lit_inter_ter_p <-  hdr(ter_models$`log10(Bodymass.g.):Light_Levellow`)
phylo_ter_p <-  hdr(ter_models$phylogenetic.variance)
H_ter <- ter_models$phylogenetic.variance/c(ter_models$phylogenetic.variance + ter_models$residual.variance)
unit_ter_p <-  hdr(ter_models$residual.variance)
cff_m <- cff_clean[cff_clean$Habitat %in% c("pelagic",
"demersal"
#"marine_reef",
#"benthopelagic"
#,"bathypelagic"
),]
cff_m$Habitat <- factor(cff_m$Habitat,
levels = c("demersal",
"pelagic"
#"marine_reef",
#"benthopelagic",
#"bathypelagic"
))
mar_models <-   read.mulTree(mulTree.chain = "cff_mar_models",
convergence = FALSE,
model = FALSE,
extract = NULL)
inter_mar_p <-  hdr(mar_models$`(Intercept)`)
mass_log10_mar_p <-  hdr(mar_models$`log10(Bodymass.g.)`)
lit_low_mar_p <-  hdr(mar_models$Light_Levellow)
ballistic_mar_p <-  hdr(mar_models$mode_of_lifepred_ballistic)
#scav_mar_p <-  hdr(mar_models$mode_of_lifescavenger)
pur_mar_p <-  hdr(mar_models$mode_of_lifepred_pursuit)
body_lit_inter_mar_p <-  hdr(mar_models$`log10(Bodymass.g.):Light_Levellow`)
phylo_mar_p <-  hdr(mar_models$phylogenetic.variance)
H_mar <- mar_models$phylogenetic.variance/c(mar_models$phylogenetic.variance + mar_models$residual.variance)
unit_mar_p <-  hdr(mar_models$residual.variance)
plot(cff_m[, "Max_CFF_Hz"] ~ jitter(as.numeric(cff_m[, "mode_of_life"])),
col = "white",
pch= 16,
bty = "n",
xlim = c(0.5,4.5))
points(cff_m[cff_m$Light_Level == "low", "Max_CFF_Hz"] ~ jitter(as.numeric(cff_m[cff_m$Light_Level == "low", "mode_of_life"]), 0.5),
col = "grey70",
pch= 16)
points(cff_m[cff_m$Light_Level == "high", "Max_CFF_Hz"] ~ jitter(as.numeric(cff_m[cff_m$Light_Level == "high", "mode_of_life"]), 0.5),
col = rgb(247/250,224/250,89/250),
pch= 16)
points(median(cff_m[cff_m$mode_of_life == "pred_forage", "Max_CFF_Hz"]) ~ c(1), pch = 3 )
points(median(cff_m[cff_m$mode_of_life == "pred_ballistic", "Max_CFF_Hz"]) ~ c(3), pch = 3 )
points(median(cff_m[cff_m$mode_of_life == "pred_pursuit", "Max_CFF_Hz"]) ~ c(4), pch = 3 )
ballistic_mar_p
pur_mar_p
ballistic_ter_p
vol_ter_p
ballistic_ter_p
ballistic_mar_p
mass_log10_mar_p
