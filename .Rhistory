mass_log10_main_p$mode + body_lit_inter_main_p$mode,
col = "grey70",
lty = 4,
lwd = 3)
cff_t <- cff_clean[cff_clean$Habitat %in% c("volant",
"terrestrial",
"arboreal"),]
cff_t$Habitat <- factor(cff_t$Habitat,
levels = c("terrestrial",
"volant",
"arboreal"))
cff_mul_terr <- as.mulTree(cff_t,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
mulTree(mulTree.data = cff_mul_terr,
formula = Max_CFF_Hz ~ log10(Bodymass.g.)*Light_Level
+ mode_of_life
+ Habitat,
parameters = parameters,
chains = 2,
priors = prior,
convergence = 1.1,
ESS = 1000,
verbose = TRUE,
output = "cff_terr_models",
warn = FALSE,
ask = TRUE)
#full_ter_1 <- MCMCglmm(Max_CFF_Hz ~ log10(Bodymass.g.)*Light_Level
#                                  + mode_of_life
#                                  + Habitat,
#                         random = ~ animal,
#                         rcov=~ units,
#                         data = cff_t,
#                         pedigree = cff_tree[[1]],
#                         prior = prior,
#                         family=c("gaussian"),
#                        nitt = nitt, thin = thin, burnin = burnin,
#                         verbose= FALSE)
#summary(full_ter_1)
ter_models <-   read.mulTree(mulTree.chain = "cff_terr_models",
convergence = FALSE,
model = FALSE,
extract = NULL)
inter_ter_p <-  hdr(ter_models$`(Intercept)`)
mass_log10_ter_p <-  hdr(ter_models$`log10(Bodymass.g.)`)
lit_low_ter_p <-  hdr(ter_models$Light_Levellow)
ballistic_ter_p <-  hdr(ter_models$mode_of_lifepred_ballistic)
#scav_ter_p <-  hdr(ter_models$mode_of_lifescavenger)
pur_ter_p <-  hdr(ter_models$mode_of_lifepred_pursuit)
#herb_ter_p <-  hdr(ter_models$mode_of_lifeherbivore)
vol_ter_p <-  hdr(ter_models$Habitatvolant)
arb_ter_p <-  hdr(ter_models$Habitatarboreal)
body_lit_inter_ter_p <-  hdr(ter_models$`log10(Bodymass.g.):Light_Levellow`)
phylo_ter_p <-  hdr(ter_models$phylogenetic.variance)
H_ter <- ter_models$phylogenetic.variance/c(ter_models$phylogenetic.variance + ter_models$residual.variance)
unit_ter_p <-  hdr(ter_models$residual.variance)
inter_ter_p
mass_log10_ter_p
lit_low_ter_p
ballistic_ter_p
pur_ter_p
vol_ter_p
cff_t
cff_t
cff_raw <- read.csv("final_cff_data_21_june_2021.csv",
header = T,
sep = ",")
colnames(cff_raw)[1] <- "Scientific_name"
cff_raw[cff_raw$mode_of_life == "scavenger",]$mode_of_life <- "pred_forage"
cff_raw[cff_raw$mode_of_life == "herbivore",]$mode_of_life <- "pred_forage"
cff_raw[cff_raw$Habitat == "marine_reef",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "benthopelagic",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "bathypelagic",]$Habitat <- "pelagic"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("pred_forage",
"deposite",
"pred_ballistic",
#"scavenger",
"pred_pursuit"
#,"herbivore"
))
cff_raw$Habitat <- factor(cff_raw$Habitat,
levels = c("terrestrial",
"pelagic",
"demersal",
#"marine_reef",
#"bathypelagic",
"volant",
"arboreal"
#"benthopelagic"
))
cff_clean <- cff_raw[,c("Scientific_name",
"taxa_group",
"taxa_phyla",
"taxa_class",
"Light_Level",
"Method",
"Max_CFF_Hz",
"Bodymass.g.",
"Habitat",
"mode_of_life")]
cff_clean <- data.frame(cff_clean, animal = cff_clean$Scientific_name)
cff_clean <- na.omit(cff_clean)
full_ter_1 <- MCMCglmm(Max_CFF_Hz ~ log10(Bodymass.g.)*Light_Level
+ mode_of_life
+ Habitat,
random = ~ animal,
rcov=~ units,
data = cff_t,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
cff_t <- cff_clean[cff_clean$Habitat %in% c("volant",
"terrestrial",
"arboreal"),]
cff_t$Habitat <- factor(cff_t$Habitat,
levels = c("terrestrial",
"volant",
"arboreal"))
cff_mul_terr <- as.mulTree(cff_t,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
cff_t
full_ter_1 <- MCMCglmm(Max_CFF_Hz ~ log10(Bodymass.g.)*Light_Level
+ mode_of_life
+ Habitat,
random = ~ animal,
rcov=~ units,
data = cff_t,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_ter_1)
cff_raw <- read.csv("final_cff_data_21_june_2021.csv",
header = T,
sep = ",")
colnames(cff_raw)[1] <- "Scientific_name"
cff_raw[cff_raw$mode_of_life == "scavenger",]$mode_of_life <- "pred_forage"
cff_raw[cff_raw$mode_of_life == "herbivore",]$mode_of_life <- "pred_forage"
cff_raw[cff_raw$Habitat == "marine_reef",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "benthopelagic",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "bathypelagic",]$Habitat <- "pelagic"
cff_raw[cff_raw$Habitat == "arboreal",]$Habitat <- "terrestrial"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("pred_forage",
"deposite",
"pred_ballistic",
#"scavenger",
"pred_pursuit"
#,"herbivore"
))
cff_raw$Habitat <- factor(cff_raw$Habitat,
levels = c("terrestrial",
"pelagic",
"demersal",
#"marine_reef",
#"bathypelagic",
"volant",
#"arboreal"
#"benthopelagic"
))
cff_raw <- read.csv("final_cff_data_21_june_2021.csv",
header = T,
sep = ",")
colnames(cff_raw)[1] <- "Scientific_name"
cff_raw[cff_raw$mode_of_life == "scavenger",]$mode_of_life <- "pred_forage"
cff_raw[cff_raw$mode_of_life == "herbivore",]$mode_of_life <- "pred_forage"
cff_raw[cff_raw$Habitat == "marine_reef",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "benthopelagic",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "bathypelagic",]$Habitat <- "pelagic"
cff_raw[cff_raw$Habitat == "arboreal",]$Habitat <- "terrestrial"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("pred_forage",
"deposite",
"pred_ballistic",
#"scavenger",
"pred_pursuit"
#,"herbivore"
))
cff_raw$Habitat <- factor(cff_raw$Habitat,
levels = c("terrestrial",
"pelagic",
"demersal",
#"marine_reef",
#"bathypelagic",
"volant"
#"arboreal"
#"benthopelagic"
))
cff_clean <- cff_raw[,c("Scientific_name",
"taxa_group",
"taxa_phyla",
"taxa_class",
"Light_Level",
"Method",
"Max_CFF_Hz",
"Bodymass.g.",
"Habitat",
"mode_of_life")]
cff_clean <- data.frame(cff_clean, animal = cff_clean$Scientific_name)
cff_clean <- na.omit(cff_clean)
cff_t <- cff_clean[cff_clean$Habitat %in% c("volant",
"terrestrial",
"arboreal"),]
cff_t$Habitat <- factor(cff_t$Habitat,
levels = c("terrestrial",
"volant",
"arboreal"))
cff_mul_terr <- as.mulTree(cff_t,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
full_ter_1 <- MCMCglmm(Max_CFF_Hz ~ log10(Bodymass.g.)*Light_Level
+ mode_of_life
+ Habitat,
random = ~ animal,
rcov=~ units,
data = cff_t,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_ter_1)
plot(cff_t[, "Max_CFF_Hz"] ~ log10(cff_t[, "Bodymass.g."]),
col = "white",
pch= 16,
bty = "n")
points(cff_t[cff_t$Light_Level == "low", "Max_CFF_Hz"] ~ log10(cff_t[cff_t$Light_Level == "low", "Bodymass.g."]),
col = "lightblue",
pch= 16)
points(cff_t[cff_t$Light_Level == "high", "Max_CFF_Hz"] ~ log10(cff_t[cff_t$Light_Level == "high", "Bodymass.g."]),
col = "orange",
pch= 16)
##high light
abline(inter_ter_p$mode, mass_log10_ter_p$mode,
col = "orange",
lty = 4,
lwd = 3)
##low light
abline(inter_ter_p$mode + lit_low_ter_p$mode,
mass_log10_ter_p$mode + body_lit_inter_ter_p$mode,
col = "lightblue",
lty = 4,
lwd = 3)
dev.new()
plot(cff_t[, "Max_CFF_Hz"] ~ log10(cff_t[, "Bodymass.g."]),
col = "white",
pch= 16,
bty = "n")
points(cff_t[cff_t$Light_Level == "low", "Max_CFF_Hz"] ~ log10(cff_t[cff_t$Light_Level == "low", "Bodymass.g."]),
col = "lightblue",
pch= 16)
points(cff_t[cff_t$Light_Level == "high", "Max_CFF_Hz"] ~ log10(cff_t[cff_t$Light_Level == "high", "Bodymass.g."]),
col = "orange",
pch= 16)
##high light
abline(inter_ter_p$mode, mass_log10_ter_p$mode,
col = "orange",
lty = 4,
lwd = 3)
##low light
abline(inter_ter_p$mode + lit_low_ter_p$mode,
mass_log10_ter_p$mode + body_lit_inter_ter_p$mode,
col = "lightblue",
lty = 4,
lwd = 3)
cff_raw <- read.csv("final_cff_data_21_june_2021.csv",
header = T,
sep = ",")
colnames(cff_raw)[1] <- "Scientific_name"
cff_raw[cff_raw$mode_of_life == "scavenger",]$mode_of_life <- "pred_forage"
cff_raw[cff_raw$mode_of_life == "herbivore",]$mode_of_life <- "pred_forage"
cff_raw[cff_raw$Habitat == "marine_reef",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "benthopelagic",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "bathypelagic",]$Habitat <- "pelagic"
cff_raw[cff_raw$Habitat == "arboreal",]$Habitat <- "terrestrial"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("pred_forage",
"deposite",
"pred_ballistic",
#"scavenger",
"pred_pursuit"
#,"herbivore"
))
cff_raw$Habitat <- factor(cff_raw$Habitat,
levels = c("terrestrial",
"pelagic",
"demersal",
#"marine_reef",
#"bathypelagic",
"volant"
#"arboreal"
#"benthopelagic"
))
cff_clean <- cff_raw[,c("Scientific_name",
"taxa_group",
"taxa_phyla",
"taxa_class",
"Light_Level",
"Method",
"Max_CFF_Hz",
"Bodymass.g.",
"Habitat",
"mode_of_life")]
cff_clean <- data.frame(cff_clean, animal = cff_clean$Scientific_name)
cff_clean <- na.omit(cff_clean)
cff_t <- cff_clean[cff_clean$Habitat %in% c("volant",
"terrestrial",
"arboreal"),]
cff_t$Habitat <- factor(cff_t$Habitat,
levels = c("terrestrial",
"volant",
"arboreal"))
cff_mul_terr <- as.mulTree(cff_t,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
full_ter_1 <- MCMCglmm(Max_CFF_Hz ~ log10(Bodymass.g.)*Light_Level
+ mode_of_life
+ Habitat,
random = ~ animal,
rcov=~ units,
data = cff_t,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_ter_1)
dev.new()
plot(cff_t[, "Max_CFF_Hz"] ~ log10(cff_t[, "Bodymass.g."]),
col = "white",
cex = 1.3,
pch= 16,
bty = "n")
points(cff_t[cff_t$Light_Level == "low", "Max_CFF_Hz"] ~ log10(cff_t[cff_t$Light_Level == "low", "Bodymass.g."]),
col = "lightblue",
pch= 16)
points(cff_t[cff_t$Light_Level == "high", "Max_CFF_Hz"] ~ log10(cff_t[cff_t$Light_Level == "high", "Bodymass.g."]),
col = "orange",
pch= 16)
points(cff_t[cff_t$Habitat == "volant", "Max_CFF_Hz"] ~ log10(cff_t[cff_t$Habitat == "volant", "Bodymass.g."]),
col = "white",
cex = 0.7,
pch= 16)
##high light
abline(inter_ter_p$mode, mass_log10_ter_p$mode,
col = "orange",
lty = 4,
lwd = 3)
##low light
abline(inter_ter_p$mode + lit_low_ter_p$mode,
mass_log10_ter_p$mode + body_lit_inter_ter_p$mode,
col = "lightblue",
lty = 4,
lwd = 3)
log10(1)
41593 + 4596
c(41593 + 4596)/12
56,587/c(c(41593 + 4596)/12)
56587/c(c(41593 + 4596)/12)
cff_raw <- read.csv("Cff_main_data__19_11_2020.csv",
header = T,
sep = ",")
#cff_raw[cff_raw$mode_of_life == "parasite",]$mode_of_life <- "pred_forage"
#cff_raw[cff_raw$mode_of_life == "scavenger",]$mode_of_life <- "pred_forage"
#cff_raw[cff_raw$mode_of_life == "herbivore",]$mode_of_life <- "pred_forage"
#cff_raw[cff_raw$Habitat == "marine_reef",]$Habitat <- "demersal"
#cff_raw[cff_raw$Habitat == "bathypelagic",]$Habitat <- "pelagic"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("pred_forage",
"deposite",
"pred_ballistic",
"scavenger",
"pred_pursuit"
,"herbivore"
#,"parasite"
))
cff_raw$Habitat <- factor(cff_raw$Habitat,
levels = c("terrestrial",
"pelagic",
"demersal",
"marine_reef",
"bathypelagic",
"volant",
"arboreal",
"benthopelagic"
))
cff_clean_no_syn <- cff_raw[,c("Scientific_name",
"taxa_group",
"taxa_phyla",
"taxa_class",
"Light_Level",
"Method",
"Max_CFF_Hz",
"Bodymass.g.",
"Habitat",
"mode_of_life")]
cff_clean_no_syn <- na.omit(cff_clean_no_syn)
cff_raw <- read.csv("final_cff_data_21_june_2021.csv",
header = T,
sep = ",")
colnames(cff_raw)[1] <- "Scientific_name"
cff_raw[cff_raw$mode_of_life == "scavenger",]$mode_of_life <- "pred_forage"
cff_raw[cff_raw$mode_of_life == "herbivore",]$mode_of_life <- "pred_forage"
cff_raw[cff_raw$Habitat == "marine_reef",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "benthopelagic",]$Habitat <- "demersal"
cff_raw[cff_raw$Habitat == "bathypelagic",]$Habitat <- "pelagic"
cff_raw[cff_raw$Habitat == "arboreal",]$Habitat <- "terrestrial"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("pred_forage",
"deposite",
"pred_ballistic",
#"scavenger",
"pred_pursuit"
#,"herbivore"
))
cff_raw$Habitat <- factor(cff_raw$Habitat,
levels = c("terrestrial",
"pelagic",
"demersal",
#"marine_reef",
#"bathypelagic",
"volant"
#"arboreal"
#"benthopelagic"
))
cff_clean <- cff_raw[,c("Scientific_name",
"taxa_group",
"taxa_phyla",
"taxa_class",
"Light_Level",
"Method",
"Max_CFF_Hz",
"Bodymass.g.",
"Habitat",
"mode_of_life")]
cff_clean <- data.frame(cff_clean, animal = cff_clean$Scientific_name)
cff_clean <- na.omit(cff_clean)
cff_t <- cff_clean[cff_clean$Habitat %in% c("volant",
"terrestrial",
"arboreal"),]
cff_t$Habitat <- factor(cff_t$Habitat,
levels = c("terrestrial",
"volant",
"arboreal"))
cff_mul_terr <- as.mulTree(cff_t,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
full_ter_1 <- MCMCglmm(Max_CFF_Hz ~ log10(Bodymass.g.)*Light_Level
+ mode_of_life
+ Habitat,
random = ~ animal,
rcov=~ units,
data = cff_t,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_ter_1)
full_model_1 <- MCMCglmm(Max_CFF_Hz ~ log10(Bodymass.g.)*Light_Level
+ mode_of_life
+ Habitat
,
random = ~ animal,
rcov=~ units,
data = cff_clean,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_model_1)
cff_raw <- read.csv("Cff_main_data_pre_phylo_25_june_2021.csv",
header = T,
sep = ",")
getwd()
cff_raw <- read.csv("Cff_main_data_pre_phylo_25_june_2021.csv",
header = T,
sep = ",")
cff_raw <- read.csv("Cff_main_data_pre_phylo_25_june_2021.csv",
header = T,
sep = ",")
cff_raw <- read.csv("Cff_main_data_pre_phylo_25_june_2021.csv",
header = T,
sep = ",")
cff_raw <- read.csv("Cff_main_data_pre_phylo_25_june_2021.csv",
header = T,
sep = ",")
cff_raw <- read.csv("Cff_main_data_pre_phylo_25_june_2021.csv",
header = T,
sep = ",")
cff_raw <- read.csv("Cff_main_data_pre_phylo_25_june_2021.csv",
header = T,
sep = ",")
cff_raw <- read.csv("Cff_main_data_pre_phylo_25_june_2021.csv",
header = T,
sep = ",")
