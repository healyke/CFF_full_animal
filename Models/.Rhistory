verbose= FALSE)
summary(full_model_1)
full_ter_1 <- MCMCglmm(Max_CFF_Hz ~ log10(body_mass_us)*forage_light_level
+ mode_of_life
+ habitat,
random = ~ animal + Species_phylo,
rcov=~ units,
data = cff_t,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
cff_t <- cff_clean[cff_clean$Habitat %in% c("volant",
"terrestrial"
#,"arboreal"
),]
cff_t$Habitat <- factor(cff_t$Habitat,
levels = c("terrestrial",
"volant"
#,"arboreal"
))
cff_mul_terr <- as.mulTree(cff_t,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
cff_t <- cff_clean[cff_clean$Habitat %in% c("volant",
"terrestrial"
#,"arboreal"
),]
cff_t$habitat <- factor(cff_t$Habitat,
levels = c("terrestrial",
"volant"
#,"arboreal"
))
cff_mul_terr <- as.mulTree(cff_t,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
cff_t <- cff_clean[cff_clean$habitat %in% c("volant",
"terrestrial"
#,"arboreal"
),]
cff_t$habitat <- factor(cff_t$habitat,
levels = c("terrestrial",
"volant"
))
cff_mul_terr <- as.mulTree(cff_t,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
full_ter_1 <- MCMCglmm(Max_CFF_Hz ~ log10(body_mass_us)*forage_light_level
+ mode_of_life
+ habitat,
random = ~ animal + Species_phylo,
rcov=~ units,
data = cff_t,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
full_ter_1 <- MCMCglmm(CFF_max ~ log10(body_mass_us)*forage_light_level
+ mode_of_life
+ habitat,
random = ~ animal + Species_phylo,
rcov=~ units,
data = cff_t,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_ter_1)
cff_m <- cff_clean[cff_clean$habitat %in% c("pelagic",
"demersal"
#"marine_reef",
#"benthopelagic"
#,"bathypelagic"
),]
cff_m$habitat <- factor(cff_m$habitat,
levels = c("demersal",
"pelagic"
#"marine_reef",
#"benthopelagic",
#"bathypelagic"
))
cff_mul_mar <- as.mulTree(cff_m,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
full_mar_1 <- MCMCglmm(CFF_max ~ log10(body_mass_us)*forage_light_level
+ mode_of_life
+ habitat
,
random = ~ animal + Species_phylo,
rcov=~ units,
data = cff_m,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_mar_1)
duplicated(cff_clean)
duplicated(cff_clean$Species_phylo)
cff_clean[duplicated(cff_clean$Species_phylo),]
cff_clean[cff_clean$Species_phylo == "Carassius_auratus",]
cff_clean[cff_clean$Species_phylo == "Spermophilus_beecheyi",]
cff_clean[cff_clean$Species_phylo == "Columba_livia",]
cff_clean[cff_clean$Species_phylo == "Funchalia_villosa",]
cff_clean[cff_clean$Species_phylo == "Janicella_spinicauda",]
cff_clean[cff_clean$Species_phylo == "Stylocheiron_maximum",]
cff_clean[cff_clean$Species_phylo == "Stylocheiron_maximum",]
cff_clean[cff_clean$Species_phylo == "Thunnus_albacares",]
cff_clean[cff_clean$Species_phylo == "Melopsittacus_undulatus",]
cff_clean[duplicated(cff_clean$Species_phylo),]
cff_clean[duplicated(cff_clean$Species_phylo),1]
cff_clean[cff_clean$Species_phylo == "Sus_scrofa",]
cff_clean[cff_clean$Species_phylo == "Gallus_gallus",]
cff_clean[cff_clean$Species_phylo == "Mus_musculus",]
cff_clean[duplicated(cff_clean$Species_phylo),]
cff_clean[duplicated(cff_clean$Species_phylo),1]
unique(cff_clean[duplicated(cff_clean$Species_phylo),1])
cff_clean[cff_clean$Species_phylo == "Rattus_norvegicus",]
cff_clean[cff_clean$Species_phylo == "Gnathonemus_petersii",]
cff_clean[cff_clean$Species_phylo == "Ovis_aries",]
cff_clean[cff_clean$Species_phylo == "Apis_mellifera_mellifera",]
cff_clean[cff_clean$Species_phylo == "Macaca_mulatta",]
library(phytools)
library(caper)
library(MCMCglmm)
library(hdrcde)
library(mulTree)
#source("MultiDisPlot.R")
cff_raw <- read.csv("Full_CFF_working_12_7_24.csv",
header = T,
sep = ",")
cff_raw[cff_raw$habitat == "benthopelagic",]$habitat <- "pelagic"
cff_raw[cff_raw$habitat == "arboreal",]$habitat <- "terrestrial"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("forage",
"ballistic",
"pursuit"
))
cff_raw$Habitat <- factor(cff_raw$habitat,
levels = c("terrestrial",
"pelagic",
"demersal",
"volant"
))
cff_clean <- cff_raw[,c("Species_phylo",
"Class",
"habitat",
"forage_light_level",
"body_mass_us",
"mode_of_life",
"CFF_max")]
cff_clean <- data.frame(cff_clean, animal = cff_clean$Species_phylo)
cff_clean <- na.omit(cff_clean)
cff_raw <- read.csv("Full_CFF_working_12_7_24.csv",
header = T,
sep = ",")
cff_raw <- cff_raw[cff_raw$Critical_appraisal_keep == "y",]
cff_raw[cff_raw$habitat == "benthopelagic",]$habitat <- "pelagic"
cff_raw[cff_raw$habitat == "arboreal",]$habitat <- "terrestrial"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("forage",
"ballistic",
"pursuit"
))
cff_raw$Habitat <- factor(cff_raw$habitat,
levels = c("terrestrial",
"pelagic",
"demersal",
"volant"
))
cff_clean <- cff_raw[,c("Species_phylo",
"Class",
"habitat",
"forage_light_level",
"body_mass_us",
"mode_of_life",
"Method"
"CFF_max")]
cff_clean <- cff_raw[,c("Species_phylo",
"Class",
"habitat",
"forage_light_level",
"body_mass_us",
"mode_of_life",
"Method",
"CFF_max")]
cff_clean$Method
unique(cff_clean$Method)
cff_clean <- data.frame(cff_clean, animal = cff_clean$Species_phylo)
cff_clean <- na.omit(cff_clean)
cff_raw <- read.csv("Full_CFF_working_12_7_24.csv",
header = T,
sep = ",")
#This drops a couple fo studies that do not meet our criteria
cff_raw <- cff_raw[cff_raw$Critical_appraisal_keep == "y",]
cff_raw[cff_raw$habitat == "benthopelagic",]$habitat <- "pelagic"
cff_raw[cff_raw$habitat == "arboreal",]$habitat <- "terrestrial"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("forage",
"ballistic",
"pursuit"
))
cff_raw$Habitat <- factor(cff_raw$habitat,
levels = c("terrestrial",
"pelagic",
"demersal",
"volant"
))
cff_clean <- cff_raw[,c("Species_phylo",
"Class",
"habitat",
"forage_light_level",
"body_mass_us",
"mode_of_life",
"Method",
"CFF_max")]
cff_clean <- data.frame(cff_clean, animal = cff_clean$Species_phylo)
cff_clean <- na.omit(cff_clean)
cff_tree <- read.tree("cff_tree_18_july_2024.tree")
cff_mul <- as.mulTree(cff_clean,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
cff_tree <- cff_tree[1:100]
nitt <- 24000
thin <- 10
burnin <- 4000
parameters <- c(nitt,
thin,
burnin)
prior <-list(R = list(V = 1, nu=0.002),
G = list(G1=list(V = 1,n = 2,
nu=0.002),
G2=list(V = 1,n = 2,
nu=0.002)
))
full_model_1 <- MCMCglmm(CFF_max ~ log10(body_mass_us)*forage_light_level
+ mode_of_life
+ habitat
+ Method
,
random = ~ animal + Species_phylo,
rcov=~ units,
data = cff_clean,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_model_1)
cff_t <- cff_clean[cff_clean$habitat %in% c("volant",
"terrestrial"
#,"arboreal"
),]
cff_t$habitat <- factor(cff_t$habitat,
levels = c("terrestrial",
"volant"
))
cff_mul_terr <- as.mulTree(cff_t,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
full_ter_1 <- MCMCglmm(CFF_max ~ log10(body_mass_us)*forage_light_level
+ mode_of_life
+ habitat + Method,
random = ~ animal + Species_phylo,
rcov=~ units,
data = cff_t,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_ter_1)
cff_m <- cff_clean[cff_clean$habitat %in% c("pelagic",
"demersal"
#"marine_reef",
#"benthopelagic"
#,"bathypelagic"
),]
cff_m$habitat <- factor(cff_m$habitat,
levels = c("demersal",
"pelagic"
#"marine_reef",
#"benthopelagic",
#"bathypelagic"
))
cff_mul_mar <- as.mulTree(cff_m,
cff_tree,
taxa = "animal",
rand.terms = ~animal,
clean.data = FALSE)
full_mar_1 <- MCMCglmm(CFF_max ~ log10(body_mass_us)*forage_light_level
+ mode_of_life
+ habitat
+ Method
,
random = ~ animal + Species_phylo,
rcov=~ units,
data = cff_m,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_mar_1)
unique(cff_raw$Species_phylo)
(cff_raw$Species_phylo)
summary(full_model_1)
summary(full_ter_1)
summary(full_mar_1)
full_logmodel_1 <- MCMCglmm(log10(CFF_max) ~ log10(body_mass_us)*forage_light_level
+ mode_of_life
+ habitat
+ Method
,
random = ~ animal + Species_phylo,
rcov=~ units,
data = cff_clean,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_logmodel_1)
summary(full_logmodel_1)
full_mar_1 <- MCMCglmm(log10(CFF_max) ~ log10(body_mass_us)*forage_light_level
+ mode_of_life
+ habitat
+ Method
,
random = ~ animal + Species_phylo,
rcov=~ units,
data = cff_m,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_mar_1)
full_logter_1 <- MCMCglmm(log10(CFF_max) ~ log10(body_mass_us)*forage_light_level
+ mode_of_life
+ habitat + Method,
random = ~ animal + Species_phylo,
rcov=~ units,
data = cff_t,
pedigree = cff_tree[[1]],
prior = prior,
family=c("gaussian"),
nitt = nitt, thin = thin, burnin = burnin,
verbose= FALSE)
summary(full_ter_1)
summary(full_model_1)
summary(full_logmodel_1)
cff_raw <- read.csv("Full_CFF_working_12_7_24.csv",
header = T,
sep = ",")
#This drops a couple fo studies that do not meet our criteria
cff_raw <- cff_raw[cff_raw$Critical_appraisal_keep == "y",]
cff_raw[cff_raw$habitat == "benthopelagic",]$habitat <- "pelagic"
cff_raw[cff_raw$habitat == "arboreal",]$habitat <- "terrestrial"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("forage",
"ballistic",
"pursuit"
))
cff_raw$Habitat <- factor(cff_raw$habitat,
levels = c("terrestrial",
"pelagic",
"demersal",
"volant"
))
cff_clean <- cff_raw[,c("Species_phylo",
"Class",
"habitat",
"forage_light_level",
"body_mass_us",
"mode_of_life",
"Method",
"CFF_max")]
cff_clean <- data.frame(cff_clean, animal = cff_clean$Species_phylo)
cff_clean <- na.omit(cff_clean)
library(phytools)
library(caper)
library(MCMCglmm)
library(hdrcde)
library(mulTree)
#source("MultiDisPlot.R")
cff_raw <- read.csv("Full_CFF_working_12_7_24.csv",
header = T,
sep = ",")
cff_raw <- cff_raw[cff_raw$Critical_appraisal_keep == "y",]
cff_raw[cff_raw$habitat == "benthopelagic",]$habitat <- "pelagic"
cff_raw[cff_raw$habitat == "arboreal",]$habitat <- "terrestrial"
cff_raw$mode_of_life <- factor(cff_raw$mode_of_life,
levels = c("forage",
"ballistic",
"pursuit"
))
cff_raw$Habitat <- factor(cff_raw$habitat,
levels = c("terrestrial",
"pelagic",
"demersal",
"volant"
))
cff_clean <- cff_raw[,c("Species_phylo",
"Class",
"habitat",
"forage_light_level",
"body_mass_us",
"mode_of_life",
"Method",
"CFF_max")]
cff_clean <- data.frame(cff_clean, animal = cff_clean$Species_phylo)
cff_clean <- na.omit(cff_clean)
cff_tree <- read.tree("cff_tree_18_july_2024.tree")
cff_tree <- cff_tree[1:100]
rownames(cff_clean) <- unique(cff_clean$Species_phylo)
cff_phylo_plot <- data.fram(cff_clean$Species_phylo,
cff_clean$CFF_max,
cff_clean$forage_light_level)
cff_phylo_plot <- data.frame(cff_clean$Species_phylo,
cff_clean$CFF_max,
cff_clean$forage_light_level)
dublicate(cff_phylo_plot)
dublicated(cff_phylo_plot)
duplicate(cff_phylo_plot)
duplicated()
duplicated(cff_phylo_plot)
duplicated(cff_phylo_plot$cff_clean.Species_phylo)
cff_phylo_plot[duplicated(cff_phylo_plot$cff_clean.Species_phylo),]
cff_phylo_plot <- cff_phylo_plot[cff_phylo_plot$cff_clean.Species_phylo == "Carassius_auratus" &
cff_phylo_plot$cff_clean.CFF_max != 24.0,]
cff_phylo_plot <- c()
unique(cff_clean$Species_phylo)
for(i in 1:length(unique(cff_clean$Species_phylo))){
cff_phylo_plot_species[i] <-  unique(cff_clean$Species_phylo)[i]
cff_phylo_plot_light[i] <-  cff_clean[cff_clean$Species_phylo == unique(cff_clean$Species_phylo)[i], "forage_light_level"][1]
cff_phylo_plot_cff[i] <-  max(cff_clean[cff_clean$Species_phylo == unique(cff_clean$Species_phylo)[i], "CFF_max"])
}
cff_phylo_plot_cff <- c()
cff_phylo_plot_light <- c()
cff_phylo_plot_species <- c()
for(i in 1:length(unique(cff_clean$Species_phylo))){
cff_phylo_plot_species[i] <-  unique(cff_clean$Species_phylo)[i]
cff_phylo_plot_light[i] <-  cff_clean[cff_clean$Species_phylo == unique(cff_clean$Species_phylo)[i], "forage_light_level"][1]
cff_phylo_plot_cff[i] <-  max(cff_clean[cff_clean$Species_phylo == unique(cff_clean$Species_phylo)[i], "CFF_max"])
}
for(i in 1:length(unique(cff_clean$Species_phylo))){
cff_phylo_plot_species[i] <-  unique(cff_clean$Species_phylo)[i]
cff_phylo_plot_light[i] <-  cff_clean[cff_clean$Species_phylo == unique(cff_clean$Species_phylo)[i], "forage_light_level"][1]
cff_phylo_plot_cff[i] <-  max(cff_clean[cff_clean$Species_phylo == unique(cff_clean$Species_phylo)[i], "CFF_max"])
}
cff_phylo_plot_species
cff_phylo_plot_cff
cff_phylo_plot <- data.frame(cff_phylo_plot_species,
cff_phylo_plot_light,
cff_phylo_plot_cff)
rownames(cff_clean) <- cff_phylo_plot$cff_phylo_plot_species
rownames(cff_phylo_plot) <- cff_phylo_plot$cff_phylo_plot_species
Max_CFF_Hz_plot <-setNames(cff_phylo_plot$cff_phylo_plot_cff,rownames(cff_phylo_plot))
par(mar=c(5.1,4.1,4.1,2.1))
dev.new()
plotTree.wBars(cff_tree[[1]],
Max_CFF_Hz_plot,
type = "fan",
scale = 0.5,
tip.labels = F, cex = 0.2)
plot(cff_tree[[1]],
type = "fan",
cex = 0.5)
dev.new()
par(mar=c(5.1,4.1,4.1,2.1))
plotTree.wBars(cff_tree[[1]],
Max_CFF_Hz_plot,
type = "fan",
scale = 0.5,
tip.labels = F, cex = 0.2)
par(mar=c(5.1,4.1,4.1,2.1))
plot(cff_tree[[1]],
type = "fan",
cex = 0.5)
dev.new()
par(mar=c(5.1,4.1,4.1,2.1))
plot(cff_tree[[1]],
type = "fan",
cex = 0.5)
dev.new()
par(mar=c(4.1,4.1,4.1,2.1))
plot(cff_tree[[1]],
type = "fan",
cex = 0.5)
dev.new()
par(mar=c(2.1,4.1,4.1,2.1))
plot(cff_tree[[1]],
type = "fan",
cex = 0.5)
1950.90 - 558.97
mean(c(68.3, 54.4, 39.5, 86.1))
